<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Aurora Scheduler</title>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.1/css/bootstrap.min.css">
    <link href="/assets/css/main.css" rel="stylesheet">
	<!-- Analytics -->
	<script type="text/javascript">
		  var _gaq = _gaq || [];
		  _gaq.push(['_setAccount', 'UA-45879646-1']);
		  _gaq.push(['_setDomainName', 'apache.org']);
		  _gaq.push(['_trackPageview']);

		  (function() {
		    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
		    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
		    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
		  })();
	</script>
  </head>
  <body>
    <div class="container-fluid section-header">
  <div class="container">
    <div class="nav nav-bar">
    <a href="/"><img src="/assets/img/aurora_logo_dkbkg.svg" width="300" alt="Transparent Aurora Scheduler logo with dark background"/></a>
    <ul class="nav navbar-nav navbar-right">
      <li><a href="/documentation/latest/">Documentation</a></li>
      <li><a href="/community/">Community</a></li>
      <li><a href="/downloads/">Downloads</a></li>
      <li><a href="/blog/">Blog</a></li>
    </ul>
    </div>
  </div>
</div>
	
    <div class="container-fluid">
      <div class="container content">
        <h1 id="webhooks">Webhooks</h1>

<p>Aurora has an optional feature which allows operator to specify a file to configure a HTTP webhook
to receive task state change events. It can be enabled with a scheduler flag eg
<code>-webhook_config=/path/to/webhook.json</code>. At this point, webhooks are still considered <em>experimental</em>.</p>

<p>Below is a sample configuration:</p>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"headers"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nt">"Content-Type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"application/vnd.kafka.json.v1+json"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"Producer-Type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"reliable"</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="nt">"targetURL"</span><span class="p">:</span><span class="w"> </span><span class="s2">"http://localhost:5000/"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"timeoutMsec"</span><span class="p">:</span><span class="w"> </span><span class="mi">5</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<p>And an example of a response that you will get back:</p>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
    </span><span class="nt">"task"</span><span class="p">:</span><span class="w">
    </span><span class="p">{</span><span class="w">
        </span><span class="nt">"cachedHashCode"</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span><span class="w">
        </span><span class="nt">"assignedTask"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
            </span><span class="nt">"cachedHashCode"</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span><span class="w">
            </span><span class="nt">"taskId"</span><span class="p">:</span><span class="s2">"vagrant-test-http_example-8-a6cf7ec5-d793-49c7-b10f-0e14ab80bfff"</span><span class="p">,</span><span class="w">
            </span><span class="nt">"task"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
                </span><span class="nt">"cachedHashCode"</span><span class="p">:</span><span class="mi">-1819348376</span><span class="p">,</span><span class="w">
                </span><span class="nt">"job"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
                    </span><span class="nt">"cachedHashCode"</span><span class="p">:</span><span class="mi">803049425</span><span class="p">,</span><span class="w">
                    </span><span class="nt">"role"</span><span class="p">:</span><span class="s2">"vagrant"</span><span class="p">,</span><span class="w">
                    </span><span class="nt">"environment"</span><span class="p">:</span><span class="s2">"test"</span><span class="p">,</span><span class="w">
                    </span><span class="nt">"name"</span><span class="p">:</span><span class="s2">"http_example"</span><span class="w">
                    </span><span class="p">},</span><span class="w">
                </span><span class="nt">"owner"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
                    </span><span class="nt">"cachedHashCode"</span><span class="p">:</span><span class="mi">226895216</span><span class="p">,</span><span class="w">
                    </span><span class="nt">"user"</span><span class="p">:</span><span class="s2">"vagrant"</span><span class="w">
                    </span><span class="p">},</span><span class="w">
                </span><span class="nt">"isService"</span><span class="p">:</span><span class="kc">true</span><span class="p">,</span><span class="w">
                </span><span class="nt">"numCpus"</span><span class="p">:</span><span class="mf">0.1</span><span class="p">,</span><span class="w">
                </span><span class="nt">"ramMb"</span><span class="p">:</span><span class="mi">16</span><span class="p">,</span><span class="w">
                </span><span class="nt">"diskMb"</span><span class="p">:</span><span class="mi">8</span><span class="p">,</span><span class="w">
                </span><span class="nt">"priority"</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span><span class="w">
                </span><span class="nt">"maxTaskFailures"</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span><span class="w">
                </span><span class="nt">"production"</span><span class="p">:</span><span class="kc">false</span><span class="p">,</span><span class="w">
                </span><span class="nt">"resources"</span><span class="p">:[</span><span class="w">
                    </span><span class="p">{</span><span class="nt">"cachedHashCode"</span><span class="p">:</span><span class="mi">729800451</span><span class="p">,</span><span class="nt">"setField"</span><span class="p">:</span><span class="s2">"NUM_CPUS"</span><span class="p">,</span><span class="nt">"value"</span><span class="p">:</span><span class="mf">0.1</span><span class="p">},</span><span class="w">
                    </span><span class="p">{</span><span class="nt">"cachedHashCode"</span><span class="p">:</span><span class="mi">552899914</span><span class="p">,</span><span class="nt">"setField"</span><span class="p">:</span><span class="s2">"RAM_MB"</span><span class="p">,</span><span class="nt">"value"</span><span class="p">:</span><span class="mi">16</span><span class="p">},</span><span class="w">
                    </span><span class="p">{</span><span class="nt">"cachedHashCode"</span><span class="p">:</span><span class="mi">-1547868317</span><span class="p">,</span><span class="nt">"setField"</span><span class="p">:</span><span class="s2">"DISK_MB"</span><span class="p">,</span><span class="nt">"value"</span><span class="p">:</span><span class="mi">8</span><span class="p">},</span><span class="w">
                    </span><span class="p">{</span><span class="nt">"cachedHashCode"</span><span class="p">:</span><span class="mi">1957328227</span><span class="p">,</span><span class="nt">"setField"</span><span class="p">:</span><span class="s2">"NAMED_PORT"</span><span class="p">,</span><span class="nt">"value"</span><span class="p">:</span><span class="s2">"http"</span><span class="p">},</span><span class="w">
                    </span><span class="p">{</span><span class="nt">"cachedHashCode"</span><span class="p">:</span><span class="mi">1954229436</span><span class="p">,</span><span class="nt">"setField"</span><span class="p">:</span><span class="s2">"NAMED_PORT"</span><span class="p">,</span><span class="nt">"value"</span><span class="p">:</span><span class="s2">"tcp"</span><span class="p">}</span><span class="w">
                    </span><span class="p">],</span><span class="w">
                </span><span class="nt">"constraints"</span><span class="p">:[],</span><span class="w">
                </span><span class="nt">"requestedPorts"</span><span class="p">:[</span><span class="s2">"http"</span><span class="p">,</span><span class="s2">"tcp"</span><span class="p">],</span><span class="w">
                </span><span class="nt">"taskLinks"</span><span class="p">:{</span><span class="nt">"http"</span><span class="p">:</span><span class="s2">"http://%host%:%port:http%"</span><span class="p">},</span><span class="w">
                </span><span class="nt">"contactEmail"</span><span class="p">:</span><span class="s2">"vagrant@localhost"</span><span class="p">,</span><span class="w">
                </span><span class="nt">"executorConfig"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
                    </span><span class="nt">"cachedHashCode"</span><span class="p">:</span><span class="mi">-1194797325</span><span class="p">,</span><span class="w">
                    </span><span class="nt">"name"</span><span class="p">:</span><span class="s2">"AuroraExecutor"</span><span class="p">,</span><span class="w">
                    </span><span class="nt">"data"</span><span class="p">:</span><span class="w"> </span><span class="s2">"{\"environment\": \"test\", \"health_check_config\": {\"initial_interval_secs\": 5.0, \"health_checker\": { \"http\": {\"expected_response_code\": 0, \"endpoint\": \"/health\", \"expected_response\": \"ok\"}}, \"max_consecutive_failures\": 0, \"timeout_secs\": 1.0, \"interval_secs\": 1.0}, \"name\": \"http_example\", \"service\": true, \"max_task_failures\": 1, \"cron_collision_policy\": \"KILL_EXISTING\", \"enable_hooks\": false, \"cluster\": \"devcluster\", \"task\": {\"processes\": [{\"daemon\": false, \"name\": \"echo_ports\", \"ephemeral\": false, \"max_failures\": 1, \"min_duration\": 5, \"cmdline\": \"echo \\\"tcp port: {{thermos.ports[tcp]}}; http port: {{thermos.ports[http]}}; alias: {{thermos.ports[alias]}}\\\"\", \"final\": false}, {\"daemon\": false, \"name\": \"stage_server\", \"ephemeral\": false, \"max_failures\": 1, \"min_duration\": 5, \"cmdline\": \"cp /vagrant/src/test/sh/org/apache/aurora/e2e/http_example.py .\", \"final\": false}, {\"daemon\": false, \"name\": \"run_server\", \"ephemeral\": false, \"max_failures\": 1, \"min_duration\": 5, \"cmdline\": \"python http_example.py {{thermos.ports[http]}}\", \"final\": false}], \"name\": \"http_example\", \"finalization_wait\": 30, \"max_failures\": 1, \"max_concurrency\": 0, \"resources\": {\"disk\": 8388608, \"ram\": 16777216, \"cpu\": 0.1}, \"constraints\": [{\"order\": [\"echo_ports\", \"stage_server\", \"run_server\"]}]}, \"production\": false, \"role\": \"vagrant\", \"contact\": \"vagrant@localhost\", \"announce\": {\"primary_port\": \"http\", \"portmap\": {\"alias\": \"http\"}}, \"lifecycle\": {\"http\": {\"graceful_shutdown_endpoint\": \"/quitquitquit\", \"port\": \"health\", \"shutdown_endpoint\": \"/abortabortabort\"}}, \"priority\": 0}"</span><span class="p">},</span><span class="w">
                    </span><span class="nt">"metadata"</span><span class="p">:[],</span><span class="w">
                    </span><span class="nt">"container"</span><span class="p">:{</span><span class="w">
                        </span><span class="nt">"cachedHashCode"</span><span class="p">:</span><span class="mi">-1955376216</span><span class="p">,</span><span class="w">
                        </span><span class="nt">"setField"</span><span class="p">:</span><span class="s2">"MESOS"</span><span class="p">,</span><span class="w">
                        </span><span class="nt">"value"</span><span class="p">:{</span><span class="nt">"cachedHashCode"</span><span class="p">:</span><span class="mi">31</span><span class="p">}}</span><span class="w">
                    </span><span class="p">},</span><span class="w">
                    </span><span class="nt">"assignedPorts"</span><span class="p">:{},</span><span class="w">
                    </span><span class="nt">"instanceId"</span><span class="p">:</span><span class="mi">8</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="nt">"status"</span><span class="p">:</span><span class="s2">"PENDING"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"failureCount"</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span><span class="w">
        </span><span class="nt">"taskEvents"</span><span class="p">:[</span><span class="w">
            </span><span class="p">{</span><span class="nt">"cachedHashCode"</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span><span class="nt">"timestamp"</span><span class="p">:</span><span class="mi">1464992060258</span><span class="p">,</span><span class="nt">"status"</span><span class="p">:</span><span class="s2">"PENDING"</span><span class="p">,</span><span class="nt">"scheduler"</span><span class="p">:</span><span class="s2">"aurora"</span><span class="p">}]</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="nt">"oldState"</span><span class="p">:{}}</span><span class="w">
</span></code></pre>

      </div>
    </div>
  	<div class="container-fluid section-footer buffer">
      <div class="container">
        <div class="row">
		  <div class="col-md-2 col-md-offset-1"><h3>Quick Links</h3>
		  <ul>
		    <li><a href="/downloads/">Downloads</a></li>
			<li><a href="https://github.com/aurora-scheduler/aurora/issues">Issue Tracking</a></li>
			<li><a href="/documentation/latest/contributing/">How To Contribute</a></li>     
		  </ul>
	      </div>
		  <div class="col-md-6">
			<p class="disclaimer">Licensed under the <a href="http://www.apache.org/licenses/">Apache License v2.0</a>. The <a href="https://www.flickr.com/photos/trondk/12706051375/">Aurora Borealis IX photo</a> displayed on the homepage is available under a <a href="https://creativecommons.org/licenses/by-nc-nd/2.0/">Creative Commons BY-NC-ND 2.0 license</a>.</p>
        </div>
      </div>
    </div>

  </body>
</html>
